{"ast":null,"code":"import _objectSpread from\"C:/Users/shiva/Desktop/talentflow-mini-hiring-platform/TalentFlow/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useMemo}from'react';import{Link}from'react-router-dom';import{PlusIcon,MagnifyingGlassIcon,FunnelIcon,EyeIcon,PencilIcon,ArchiveBoxIcon,ArchiveBoxXMarkIcon,Bars3Icon,ArrowLeftIcon}from'@heroicons/react/24/outline';import JobModal from'./JobModal';import toast from'react-hot-toast';import{apiCall}from'../utils/apiUtils';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const PAGE_SIZE=12;const JobListSimple=()=>{const[jobs,setJobs]=useState([]);const[allJobs,setAllJobs]=useState([]);const[loading,setLoading]=useState(true);const[searchTerm,setSearchTerm]=useState('');const[statusFilter,setStatusFilter]=useState('');const[tagFilter,setTagFilter]=useState('');const[page,setPage]=useState(1);const[showModal,setShowModal]=useState(false);const[editingJob,setEditingJob]=useState(null);const[draggedJob,setDraggedJob]=useState(null);useEffect(()=>{loadJobs();},[]);// Listen for keyboard shortcut to open modal\nuseEffect(()=>{const handleOpenModal=()=>{handleCreateJob();};window.addEventListener('openJobModal',handleOpenModal);return()=>window.removeEventListener('openJobModal',handleOpenModal);},[]);const filteredJobs=useMemo(()=>{let filtered=allJobs;if(searchTerm.trim()){const searchLower=searchTerm.toLowerCase().trim();filtered=filtered.filter(job=>job.title.toLowerCase().includes(searchLower)||job.description.toLowerCase().includes(searchLower)||job.location.toLowerCase().includes(searchLower)||job.tags.some(tag=>tag.toLowerCase().includes(searchLower)));}if(statusFilter){filtered=filtered.filter(job=>job.status===statusFilter);}if(tagFilter){filtered=filtered.filter(job=>job.tags.includes(tagFilter));}return filtered;},[allJobs,searchTerm,statusFilter,tagFilter]);const paginatedJobs=useMemo(()=>{const startIndex=(page-1)*PAGE_SIZE;return filteredJobs.slice(startIndex,startIndex+PAGE_SIZE);},[filteredJobs,page]);const totalPages=Math.ceil(filteredJobs.length/PAGE_SIZE);const uniqueTags=useMemo(()=>Array.from(new Set(allJobs.flatMap(job=>job.tags))),[allJobs]);const loadJobs=async()=>{try{setLoading(true);const response=await apiCall('/api/jobs?page=1&pageSize=1000');if(!response.ok){throw new Error(\"HTTP \".concat(response.status,\": \").concat(response.statusText));}const data=await response.json();if(!data||!data.data||!Array.isArray(data.data)){throw new Error('Invalid response format');}const sortedJobs=data.data.sort((a,b)=>a.order-b.order);setAllJobs(sortedJobs);setJobs(sortedJobs);}catch(error){console.error('Error loading jobs:',error);toast.error('Failed to load jobs. Please refresh the page.');// Fallback to empty array\nsetAllJobs([]);setJobs([]);}finally{setLoading(false);}};const handleCreateJob=()=>{setEditingJob(null);setShowModal(true);};const handleJobSave=()=>{loadJobs();};const handleArchiveJob=async job=>{try{const response=await fetch(\"/api/jobs/\".concat(job.id),{method:'PATCH',headers:{'Content-Type':'application/json'},body:JSON.stringify({status:job.status==='active'?'archived':'active'})});if(!response.ok)throw new Error('Failed to update job');toast.success(\"Job \".concat(job.status==='active'?'archived':'unarchived',\" successfully!\"));loadJobs();}catch(error){toast.error('Failed to update job');}};// Simple drag and drop handlers\nconst handleDragStart=(e,job)=>{setDraggedJob(job);e.dataTransfer.effectAllowed='move';};const handleDragOver=e=>{e.preventDefault();e.dataTransfer.dropEffect='move';};const handleDrop=async(e,targetJob)=>{e.preventDefault();if(!draggedJob||draggedJob.id===targetJob.id){setDraggedJob(null);return;}// Optimistic update\nconst updatedJobs=[...allJobs];const draggedIndex=updatedJobs.findIndex(j=>j.id===draggedJob.id);const targetIndex=updatedJobs.findIndex(j=>j.id===targetJob.id);if(draggedIndex!==-1&&targetIndex!==-1){// Swap positions\nconst temp=updatedJobs[draggedIndex];updatedJobs[draggedIndex]=_objectSpread(_objectSpread({},updatedJobs[targetIndex]),{},{order:draggedJob.order});updatedJobs[targetIndex]=_objectSpread(_objectSpread({},temp),{},{order:targetJob.order});setAllJobs(updatedJobs);}try{const response=await fetch(\"/api/jobs/\".concat(draggedJob.id,\"/reorder\"),{method:'PATCH',headers:{'Content-Type':'application/json'},body:JSON.stringify({fromOrder:draggedJob.order,toOrder:targetJob.order})});if(!response.ok)throw new Error('Failed to reorder');toast.success('Job reordered successfully!');// Don't reload, keep optimistic update\n}catch(error){toast.error('Failed to reorder job');// Revert on error\nloadJobs();}finally{setDraggedJob(null);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-400\",children:\"Loading jobs...\"})]})});}return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 dark:bg-gray-900\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center mb-6\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>window.history.back(),className:\"inline-flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors\",children:[/*#__PURE__*/_jsx(ArrowLeftIcon,{className:\"w-5 h-5 mr-2\"}),\"Go Back\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900 dark:text-white mb-2\",children:\"Job Listings\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 dark:text-gray-400\",children:[\"Manage and organize your job postings \\u2022 \",filteredJobs.length,\" jobs found\"]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleCreateJob,className:\"mt-4 sm:mt-0 inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200 shadow-sm hover:shadow-md\",children:[/*#__PURE__*/_jsx(PlusIcon,{className:\"w-5 h-5 mr-2\"}),\"Create Job\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(MagnifyingGlassIcon,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search jobs, descriptions, locations...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:statusFilter,onChange:e=>setStatusFilter(e.target.value),className:\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Status\"}),/*#__PURE__*/_jsx(\"option\",{value:\"active\",children:\"Active\"}),/*#__PURE__*/_jsx(\"option\",{value:\"archived\",children:\"Archived\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:tagFilter,onChange:e=>setTagFilter(e.target.value),className:\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Tags\"}),uniqueTags.map(tag=>/*#__PURE__*/_jsx(\"option\",{value:tag,children:tag},tag))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-sm text-gray-500 dark:text-gray-400\",children:[/*#__PURE__*/_jsx(FunnelIcon,{className:\"w-4 h-4 mr-2\"}),filteredJobs.length,\" of \",allJobs.length,\" jobs\"]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\",children:paginatedJobs.map(job=>/*#__PURE__*/_jsxs(\"div\",{draggable:true,onDragStart:e=>handleDragStart(e,job),onDragOver:handleDragOver,onDrop:e=>handleDrop(e,job),className:\"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 transition-all duration-200 hover:shadow-md cursor-move \".concat((draggedJob===null||draggedJob===void 0?void 0:draggedJob.id)===job.id?'opacity-50 scale-95':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Bars3Icon,{className:\"w-4 h-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 text-xs font-medium rounded-full \".concat(job.status==='active'?'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200':'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200'),children:job.status})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-500\",children:[\"#\",job.order]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Link,{to:\"/jobs/\".concat(job.id),className:\"block group\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors mb-2\",children:job.title})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-300 text-sm mb-3 line-clamp-2\",children:job.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-sm text-gray-500 dark:text-gray-400 mb-3\",children:[\"\\uD83D\\uDCCD \",job.location]})]}),job.tags.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-2 mb-4\",children:[job.tags.slice(0,3).map(tag=>/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 rounded-full\",children:tag},tag)),job.tags.length>3&&/*#__PURE__*/_jsxs(\"span\",{className:\"px-2 py-1 text-xs font-medium bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 rounded-full\",children:[\"+\",job.tags.length-3]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsxs(Link,{to:\"/jobs/\".concat(job.id),className:\"inline-flex items-center px-3 py-1.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors\",children:[/*#__PURE__*/_jsx(EyeIcon,{className:\"w-4 h-4 mr-1\"}),\"View\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setEditingJob(job);setShowModal(true);},className:\"inline-flex items-center px-3 py-1.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors\",children:[/*#__PURE__*/_jsx(PencilIcon,{className:\"w-4 h-4 mr-1\"}),\"Edit\"]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleArchiveJob(job),className:\"inline-flex items-center px-3 py-1.5 text-sm font-medium rounded-lg transition-colors \".concat(job.status==='active'?'text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:text-red-300 dark:hover:bg-red-900/20':'text-green-600 hover:text-green-700 hover:bg-green-50 dark:text-green-400 dark:hover:text-green-300 dark:hover:bg-green-900/20'),children:job.status==='active'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ArchiveBoxIcon,{className:\"w-4 h-4 mr-1\"}),\"Archive\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ArchiveBoxXMarkIcon,{className:\"w-4 h-4 mr-1\"}),\"Unarchive\"]})})]})]},job.id))}),filteredJobs.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl mb-4\",children:\"\\uD83D\\uDCBC\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 dark:text-white mb-2\",children:\"No jobs found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-400 mb-6\",children:searchTerm||statusFilter||tagFilter?'Try adjusting your filters to see more results.':'Get started by creating your first job posting.'}),!searchTerm&&!statusFilter&&!tagFilter&&/*#__PURE__*/_jsxs(\"button\",{onClick:handleCreateJob,className:\"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors\",children:[/*#__PURE__*/_jsx(PlusIcon,{className:\"w-5 h-5 mr-2\"}),\"Create Your First Job\"]})]}),totalPages>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center items-center space-x-4 mt-8\",children:[/*#__PURE__*/_jsx(\"button\",{disabled:page===1,onClick:()=>setPage(page-1),className:\"px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\",children:\"Previous\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-600 dark:text-gray-400\",children:[\"Page \",page,\" of \",totalPages]}),/*#__PURE__*/_jsx(\"button\",{disabled:page===totalPages,onClick:()=>setPage(page+1),className:\"px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\",children:\"Next\"})]}),/*#__PURE__*/_jsx(JobModal,{isOpen:showModal,onClose:()=>{setShowModal(false);setEditingJob(null);},job:editingJob,onSave:handleJobSave})]})});};export default JobListSimple;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,Link,useNavigate}from'react-router-dom';import{motion}from'framer-motion';import{ArrowLeftIcon,PencilIcon,DocumentTextIcon,UserGroupIcon,CalendarIcon,MapPinIcon,EyeIcon,ClockIcon,CheckCircleIcon,XCircleIcon}from'@heroicons/react/24/outline';import JobModal from'../components/JobModal';import JobApplications from'../components/JobApplications';import{apiCall}from'../utils/apiUtils';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const JobDetailProfessional=()=>{const{jobId}=useParams();const navigate=useNavigate();const[job,setJob]=useState(null);const[candidates,setCandidates]=useState([]);const[loading,setLoading]=useState(true);const[showEditModal,setShowEditModal]=useState(false);useEffect(()=>{if(jobId){loadJobData();}},[jobId]);const loadJobData=async()=>{try{setLoading(true);// Load job details\nconst jobResponse=await apiCall(\"/api/jobs/\".concat(jobId));if(jobResponse.ok){const jobData=await jobResponse.json();setJob(jobData.data);}// Load candidates for this job\nconst candidatesResponse=await apiCall(\"/api/candidates?jobId=\".concat(jobId,\"&page=1&pageSize=100\"));if(candidatesResponse.ok){const candidatesData=await candidatesResponse.json();setCandidates(candidatesData.data||[]);}}catch(error){console.error('Error loading job data:',error);toast.error('Failed to load job details');}finally{setLoading(false);}};const handleJobSave=()=>{setShowEditModal(false);loadJobData();toast.success('Job updated successfully!');};const handleArchiveJob=async()=>{if(!job)return;try{const response=await apiCall(\"/api/jobs/\".concat(job.id),{method:'PATCH',headers:{'Content-Type':'application/json'},body:JSON.stringify({status:job.status==='active'?'archived':'active'})});if(response.ok){toast.success(\"Job \".concat(job.status==='active'?'archived':'activated',\" successfully!\"));loadJobData();}}catch(error){toast.error('Failed to update job status');}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-400\",children:\"Loading job details...\"})]})});}if(!job){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl mb-4\",children:\"\\uD83D\\uDD0D\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900 dark:text-white mb-2\",children:\"Job Not Found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-400 mb-6\",children:\"The job you're looking for doesn't exist.\"}),/*#__PURE__*/_jsxs(Link,{to:\"/jobs\",className:\"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors\",children:[/*#__PURE__*/_jsx(ArrowLeftIcon,{className:\"w-5 h-5 mr-2\"}),\"Back to Jobs\"]})]})});}// Calculate candidate statistics\nconst candidateStats=candidates.reduce((acc,candidate)=>{acc[candidate.stage]=(acc[candidate.stage]||0)+1;return acc;},{});const totalCandidates=candidates.length;const activeApplications=candidates.filter(c=>!['hired','rejected'].includes(c.stage)).length;return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 dark:bg-gray-900\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4 mb-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>navigate(-1),className:\"inline-flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors\",children:[/*#__PURE__*/_jsx(ArrowLeftIcon,{className:\"w-5 h-5 mr-2\"}),\"Go Back\"]}),/*#__PURE__*/_jsx(Link,{to:\"/jobs\",className:\"inline-flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors\",children:\"All Jobs\"}),/*#__PURE__*/_jsx(Link,{to:\"/candidates\",className:\"inline-flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors\",children:\"All Candidates\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col lg:flex-row lg:items-center lg:justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mb-2\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900 dark:text-white\",children:job.title}),/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 text-sm font-medium rounded-full \".concat(job.status==='active'?'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200':'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200'),children:job.status})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap items-center gap-4 text-gray-600 dark:text-gray-400\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(MapPinIcon,{className:\"w-5 h-5 mr-1\"}),job.location]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(CalendarIcon,{className:\"w-5 h-5 mr-1\"}),\"Posted \",new Date(job.createdAt).toLocaleDateString()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(UserGroupIcon,{className:\"w-5 h-5 mr-1\"}),totalCandidates,\" candidates\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mt-4 lg:mt-0\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowEditModal(true),className:\"inline-flex items-center px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 font-medium rounded-lg transition-colors\",children:[/*#__PURE__*/_jsx(PencilIcon,{className:\"w-5 h-5 mr-2\"}),\"Edit Job\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleArchiveJob,className:\"inline-flex items-center px-4 py-2 font-medium rounded-lg transition-colors \".concat(job.status==='active'?'bg-red-600 hover:bg-red-700 text-white':'bg-green-600 hover:bg-green-700 text-white'),children:job.status==='active'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(XCircleIcon,{className:\"w-5 h-5 mr-2\"}),\"Archive Job\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"w-5 h-5 mr-2\"}),\"Activate Job\"]})}),/*#__PURE__*/_jsxs(Link,{to:\"/assessments/create?jobId=\".concat(job.id),className:\"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors\",children:[/*#__PURE__*/_jsx(DocumentTextIcon,{className:\"w-5 h-5 mr-2\"}),\"Create Assessment\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-2 space-y-8\",children:[/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:\"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-900 dark:text-white mb-4\",children:\"Job Description\"}),/*#__PURE__*/_jsx(\"div\",{className:\"prose dark:prose-invert max-w-none\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 dark:text-gray-300 leading-relaxed whitespace-pre-wrap\",children:job.description})})]}),job.tags.length>0&&/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0.1},className:\"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-900 dark:text-white mb-4\",children:\"Skills & Tags\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:job.tags.map((tag,index)=>/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 text-sm font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 rounded-full\",children:tag},tag))})]}),/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0.2},className:\"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-900 dark:text-white\",children:\"Candidate Pipeline Overview\"}),/*#__PURE__*/_jsxs(Link,{to:\"/candidates?jobId=\".concat(job.id),className:\"inline-flex items-center text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium\",children:[/*#__PURE__*/_jsx(EyeIcon,{className:\"w-5 h-5 mr-1\"}),\"Manage Candidates\"]})]}),totalCandidates>0?/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-4\",children:[{stage:'applied',label:'Applied',color:'blue'},{stage:'screen',label:'Screening',color:'yellow'},{stage:'tech',label:'Technical',color:'purple'},{stage:'offer',label:'Offer',color:'green'}].map(_ref=>{let{stage,label,color}=_ref;return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-\".concat(color,\"-600 dark:text-\").concat(color,\"-400\"),children:candidateStats[stage]||0}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600 dark:text-gray-400\",children:label})]},stage);})}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsx(UserGroupIcon,{className:\"w-12 h-12 text-gray-400 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 dark:text-white mb-2\",children:\"No Candidates Yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-400\",children:\"Candidates will appear here once they start applying to this job.\"})]})]}),/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0.3},className:\"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-900 dark:text-white mb-6\",children:\"Applications Management\"}),/*#__PURE__*/_jsx(JobApplications,{jobId:job.id})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:\"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 dark:text-white mb-4\",children:\"Quick Stats\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(UserGroupIcon,{className:\"w-5 h-5 text-blue-600 mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 dark:text-gray-400\",children:\"Total Applications\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-900 dark:text-white\",children:totalCandidates})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(ClockIcon,{className:\"w-5 h-5 text-yellow-600 mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 dark:text-gray-400\",children:\"Active Applications\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-900 dark:text-white\",children:activeApplications})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"w-5 h-5 text-green-600 mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 dark:text-gray-400\",children:\"Hired\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-900 dark:text-white\",children:candidateStats.hired||0})]})]})]}),/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:0.1},className:\"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 dark:text-white mb-4\",children:\"Quick Actions\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(Link,{to:\"/candidates?jobId=\".concat(job.id),className:\"flex items-center w-full px-4 py-2 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg transition-colors\",children:[/*#__PURE__*/_jsx(UserGroupIcon,{className:\"w-5 h-5 mr-3\"}),\"Manage Candidates\"]}),/*#__PURE__*/_jsxs(Link,{to:\"/assessments/create?jobId=\".concat(job.id),className:\"flex items-center w-full px-4 py-2 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg transition-colors\",children:[/*#__PURE__*/_jsx(DocumentTextIcon,{className:\"w-5 h-5 mr-3\"}),\"Create Assessment\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowEditModal(true),className:\"flex items-center w-full px-4 py-2 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg transition-colors\",children:[/*#__PURE__*/_jsx(PencilIcon,{className:\"w-5 h-5 mr-3\"}),\"Edit Job Details\"]})]})]}),/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:0.2},className:\"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 dark:text-white mb-4\",children:\"Job Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 dark:text-gray-400\",children:\"Job ID:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 font-mono text-gray-900 dark:text-white\",children:job.id})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 dark:text-gray-400\",children:\"Created:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-gray-900 dark:text-white\",children:new Date(job.createdAt).toLocaleDateString()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 dark:text-gray-400\",children:\"Last Updated:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-gray-900 dark:text-white\",children:new Date(job.updatedAt).toLocaleDateString()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 dark:text-gray-400\",children:\"Order:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-gray-900 dark:text-white\",children:[\"#\",job.order]})]})]})]})]})]}),/*#__PURE__*/_jsx(JobModal,{isOpen:showEditModal,onClose:()=>setShowEditModal(false),job:job,onSave:handleJobSave})]})});};export default JobDetailProfessional;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}